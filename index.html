<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ViriTTS - AI Stream Companion</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
      /* â”€â”€ Beta Testers Spotlight Carousel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
      .testers-section {
        padding: 100px 0 80px;
        text-align: center;
        overflow: hidden;
        position: relative;
      }
      .testers-header {
        display: inline-flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 12px;
      }
      .testers-header h3 {
        font-size: 2.2rem;
        font-weight: 800;
        color: #fff;
        margin: 0;
        letter-spacing: -0.02em;
      }
      .testers-live-dot {
        width: 12px; height: 12px;
        border-radius: 50%;
        background: #22c55e;
        box-shadow: 0 0 0 0 rgba(34,197,94,0.6);
        animation: testerPulse 2s infinite;
        flex-shrink: 0;
      }
      @keyframes testerPulse {
        0%   { box-shadow: 0 0 0 0 rgba(34,197,94,0.6); }
        70%  { box-shadow: 0 0 0 12px rgba(34,197,94,0); }
        100% { box-shadow: 0 0 0 0 rgba(34,197,94,0); }
      }
      .testers-badge {
        background: rgba(124, 58, 237, 0.2);
        border: 1px solid rgba(124, 58, 237, 0.4);
        color: #a78bfa;
        font-size: 0.8rem;
        font-weight: 700;
        padding: 4px 12px;
        border-radius: 30px;
        backdrop-filter: blur(4px);
      }
      .testers-sub {
        color: var(--text-secondary, #9ca3af);
        font-size: 1.1rem;
        max-width: 600px;
        margin: 0 auto 60px;
        line-height: 1.6;
      }

      /* â”€â”€ Stage: centre spotlight + side ghosts â”€â”€ */
      .testers-stage {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 30px;
        perspective: 1200px;
        min-height: 380px;
        position: relative;
      }

      /* Each slot */
      .tester-slot {
        transition: all 0.8s cubic-bezier(0.22, 1, 0.36, 1);
        flex-shrink: 0;
        will-change: transform, opacity, filter;
      }

      /* Ghost cards either side */
      .tester-slot.prev,
      .tester-slot.next {
        opacity: 0.4;
        transform: scale(0.8) translateY(10px);
        filter: blur(2px) grayscale(0.3);
        pointer-events: none;
      }
      .tester-slot.prev { transform: scale(0.8) translateX(-40px) rotateY(15deg); }
      .tester-slot.next { transform: scale(0.8) translateX( 40px) rotateY(-15deg); }

      /* Far ghosts */
      .tester-slot.far-prev,
      .tester-slot.far-next {
        opacity: 0.15;
        transform: scale(0.6) translateY(20px);
        filter: blur(4px) grayscale(0.6);
        pointer-events: none;
      }
      .tester-slot.far-prev { transform: scale(0.6) translateX(-80px) rotateY(25deg); }
      .tester-slot.far-next { transform: scale(0.6) translateX( 80px) rotateY(-25deg); }

      /* Hidden beyond range */
      .tester-slot.hidden { opacity: 0; transform: scale(0.4); pointer-events: none; }

      /* â”€â”€ The card itself â”€â”€ */
      .tester-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 20px;
        background: rgba(30, 20, 51, 0.4);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(217, 70, 239, 0.2);
        border-radius: 24px;
        padding: 40px 30px 30px;
        width: 240px;
        cursor: default;
        position: relative;
        overflow: hidden;
        transition: border-color 0.3s, background 0.3s;
      }

      /* Glowing top edge on active card */
      .tester-slot.active .tester-card {
        border-color: rgba(217, 70, 239, 0.4);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5),
                    0 0 40px rgba(217, 70, 239, 0.15);
        background: rgba(30, 20, 51, 0.6);
      }
      
      .tester-slot.active .tester-card::after {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(180deg, rgba(217, 70, 239, 0.05) 0%, transparent 100%);
        pointer-events: none;
      }

      /* Avatar */
      .tester-avatar {
        width: 120px; height: 120px;
        border-radius: 20px;
        object-fit: cover;
        border: 2px solid rgba(217, 70, 239, 0.3);
        background: #0f0816;
        transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1);
        display: block;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      }
      .tester-slot.active .tester-avatar { 
        border-color: #d946ef;
        transform: scale(1.05);
        box-shadow: 0 15px 40px rgba(217, 70, 239, 0.3);
      }
      
      .tester-avatar-placeholder {
        width: 120px; height: 120px;
        border-radius: 20px;
        background: linear-gradient(135deg, #1a112e, #0f0816);
        display: flex; align-items: center; justify-content: center;
        font-size: 2.8rem; font-weight: 800; color: #d946ef;
        border: 2px solid rgba(217, 70, 239, 0.3);
      }

      /* Text */
      .tester-info { text-align: center; z-index: 1; }
      .tester-name {
        font-size: 1.2rem; font-weight: 800;
        color: #fff; line-height: 1.2;
        text-shadow: 0 2px 10px rgba(0,0,0,0.5);
      }
      .tester-twitch {
        font-size: 0.85rem; color: #06b6d4;
        font-weight: 700; margin-top: 6px;
        letter-spacing: 0.02em;
      }

      /* Dot indicators */
      .testers-dots {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 40px;
      }
      .testers-dot {
        width: 8px; height: 8px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1);
        cursor: pointer;
        border: 1px solid rgba(255, 255, 255, 0.05);
      }
      .testers-dot.active {
        background: #d946ef;
        transform: scale(1.5);
        box-shadow: 0 0 15px rgba(217, 70, 239, 0.6);
        width: 24px;
        border-radius: 10px;
      }

      /* â”€â”€ Slot transition animations â”€â”€ */
      @keyframes tActiveIn {
        0%   { transform: scale(0.9) translateY(10px); opacity: 0; }
        100% { transform: scale(1) translateY(0);    opacity: 1; }
      }

      .tester-slot.active {
        animation: tActiveIn 0.6s cubic-bezier(0.22, 1, 0.36, 1) both;
      }
    </style>
</head>

<body>
    <div id="interactive-bg"></div>

    <!-- Lightbox Overlay -->
    <div id="lightbox">
        <img id="lightbox-img" src="" alt="Enlarged Image">
    </div>

    <div class="container">
        <header>
            <nav style="display: flex; width: 100%; justify-content: space-between; align-items: center;">
                <a href="index.html" class="logo" style="display: flex; align-items: center; gap: 0.5rem;">
                    <img src="images/Viritts1.png" alt="ViriTTS Logo Icon" style="height: 50px;">
                    <img src="images/virittstextonly.png" alt="ViriTTS Text Logo" style="height: 40px;">
                </a>
                <nav>
                    <a href="index.html">Viri.TTS</a>
                    <a href="vircast.html" style="color: var(--cyan); font-weight: 800;">VirCast Audio</a>
                    <a href="#about">About Me</a>
                    <a href="#features">Features</a>
                    <a href="#pricing">Pricing</a>
                    <a href="changelog.html">What's New</a>
                    <a href="account.html">Login</a>
                    <a href="https://discord.gg/MkJVue2Rr4" target="_blank">Support</a>
                </nav>
            </nav>
        </header>

        <section class="hero">
            <div class="hero-container">
                <!-- Image Side (Left) -->
                <div class="hero-image-wrapper">
                    <img src="images/UI.png" alt="ViriTTS Dashboard Interface" class="hero-image">
                </div>

                <!-- Text Side (Right) -->
                <div class="hero-content">
                    <h1>Your AI Stream Companion</h1>
                    <p>Engage your chat with a personality-driven AI that reacts, jokes, and manages your stream in
                        real-time.</p>
                    <div class="hero-btns">
                        <a href="beta.html" class="btn">Join the Beta</a>
                        <a id="latest-download-btn" href="account.html" class="btn btn-outline"
                            style="background: transparent; border: 2px solid var(--primary); margin-left: 1rem;">Download v1.0.0</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Marquee Carousel -->
        <div class="marquee-container">
            <div class="marquee-content">
                <span class="marquee-item">Works with Twitch</span>
                <span class="marquee-item">Built-In AI</span>
                <span class="marquee-item">Low Latency</span>
                <span class="marquee-item">Easy Config</span>
                <span class="marquee-item">ElevenLabs Compatible</span>
                <span class="marquee-item">Streamer Friendly</span>
                <span class="marquee-item">Custom Personas</span>
                <span class="marquee-item">Interactive TTS</span>
                <!-- Duplicate for seamless loop -->
                <span class="marquee-item">Works with Twitch</span>
                <span class="marquee-item">Built-In AI</span>
                <span class="marquee-item">Low Latency</span>
                <span class="marquee-item">Easy Config</span>
                <span class="marquee-item">ElevenLabs Compatible</span>
                <span class="marquee-item">Streamer Friendly</span>
                <span class="marquee-item">Custom Personas</span>
                <span class="marquee-item">Interactive TTS</span>
            </div>
        </div>

        <!-- BETA TESTERS SPOTLIGHT CAROUSEL -->
        <section class="testers-section">
          <div class="testers-header">
            <span class="testers-live-dot"></span>
            <h3>Currently Testing ViriTTS</h3>
            <span class="testers-badge" id="testers-count">â€“</span>
          </div>
          <p class="testers-sub">Real streamers. Real feedback. Building this together.</p>

          <div class="testers-stage" id="testers-stage">
            <!-- slots injected by JS -->
          </div>
          <div class="testers-dots" id="testers-dots"></div>
        </section>

        <!-- SPOTLIGHT SECTION (Community Memory) -->
        <section class="spotlight">
            <h3>Community Memory: The AI That Remembers</h3>
            <p>Viri isn't just a chatbot; it's a long-term companion. It remembers what your viewers love, hate, and
                talk about, creating personalized interactions that deepen over time.</p>

            <div class="spotlight-grid">
                <!-- Step 1 -->
                <div class="spotlight-card">
                    <div class="showcase-img-wrapper tilt-left">
                        <img src="images/communitymemory1.png" alt="User shares preference" class="showcase-img">
                    </div>
                    <div class="spotlight-caption">1. Chatter shares a detail</div>
                </div>

                <!-- Arrow -->
                <div class="spotlight-arrow">âœ</div>

                <!-- Step 2 -->
                <div class="spotlight-card">
                    <div class="showcase-img-wrapper tilt-right">
                        <img src="images/communitymemory2.png" alt="Viri remembers" class="showcase-img">
                    </div>
                    <div class="spotlight-caption">2. Viri remembers forever</div>
                </div>
            </div>
        </section>


        <!-- APP SHOWCASE SECTION -->
        <section class="showcase">
            <!-- 1. Custom Commands -->
            <div class="showcase-item">
                <div class="showcase-img-wrapper">
                    <img src="images/CustomcommandsUI.png" alt="Custom Commands Interface" class="showcase-img">
                </div>
                <div class="showcase-text">
                    <h3>Custom Command Power</h3>
                    <p>Create powerful custom commands that trigger AI responses, sound effects, or Twitch actions.
                        Configure permissions (Everyone/Mods), set keywords, and define exactly what Rye should do.</p>
                </div>
            </div>

            <!-- 2. AI Persona Settings -->
            <div class="showcase-item">
                <div class="showcase-img-wrapper">
                    <img src="images/simpleaipersonasettingsui.png" alt="AI Persona Settings" class="showcase-img">
                </div>
                <div class="showcase-text">
                    <h3>Fine-Tune Your AI</h3>
                    <p>Easily configure your AI's personality. Choose between built-in no-cost AI or bring your own
                        keys. Adjust creativity, tone, and responsiveness to match your stream's vibe perfectly.</p>
                </div>
            </div>

            <!-- 3. TTS Pet Setup -->
            <div class="showcase-item">
                <div class="showcase-img-wrapper">
                    <img src="images/ttspetsetupui.png" alt="TTS Pet Setup" class="showcase-img">
                </div>
                <div class="showcase-text">
                    <h3>Interactive TTS Pet</h3>
                    <p>Bring your AI to life with a reactive PNG Tuber! Features a <strong>built-in local
                            server</strong> for super simple operationâ€”no external apps needed. Upload your idle/talking
                        states, and it syncs perfectly with TTS audio.</p>
                </div>
            </div>

            <!-- 4. Moderation Support -->
            <div class="showcase-item">
                <div class="showcase-img-wrapper">
                    <img src="images/ModerationSupportui.png" alt="Moderation Support" class="showcase-img">
                </div>
                <div class="showcase-text">
                    <h3>Smart Moderation</h3>
                    <p>Let Rye help keep your chat safe. Configure moderation levels, blocked words, and response
                        guidelines. The AI understands context and can assist your mod team in real-time.</p>
                </div>
            </div>

            <!-- 5. Voice Control (STT) -->
            <div class="showcase-item">
                <div class="showcase-img-wrapper small-showcase-img">
                    <img src="images/STTUI.png" alt="Voice Control Interface" class="showcase-img">
                </div>
                <div class="showcase-text">
                    <h3>Real-Time Voice Control</h3>
                    <p>While your chat communicates with Viri, Viri also listens to <strong>YOU</strong> in real-time!
                        Simply say <em>"Hey Viri, shoutout the last raider"</em> and Viri will execute the command
                        instantly. No need to alt-tab or interrupt your gameplay.</p>
                </div>
            </div>

            <!-- 6. Real-Time Command Execution -->
            <div class="showcase-item">
                <div class="showcase-img-wrapper small-showcase-img">
                    <img src="images/shoutoutui.png" alt="Command Execution Interface" class="showcase-img">
                </div>
                <div class="showcase-text">
                    <h3>Unified Activity Log</h3>
                    <p>Everything in one place. Watch Viri execute chat commands like <code>!so</code> and speak your
                        TTS messages via <code>!say</code> in a single, real-time feed.</p>
                </div>
            </div>
        </section>

        <!-- WHY SUBSCRIPTION SECTION -->
        <section id="about" class="about-section">
            <div class="about-container">
                <div class="about-mascot-wrapper">
                    <img src="images/virittsplusmascot.png" alt="ViriTTS Mascot" class="about-mascot">
                </div>
                <div class="about-content">
                    <h2>Who am I, and why a Subscription?</h2>
                    <p>I'm a small Vtuber Content Creator that decided one day to fix the little problems I had by
                        building it myself! My name's <a href="https://www.twitch.tv/cryzera" target="_blank"
                            style="color: var(--cyan); text-decoration: none; font-weight: bold;">CryZera</a>. I'm what
                        you call a Scuff Vtuber, and in my streams, I often found that existing tools weren't built for
                        my needs or didn't work well together. So, I decided to build new ones that work perfectly for
                        me!</p>

                    <p>My goal is to make this tool as easy as possible to understand and get a lot of the technical
                        sides of AI out of the way. I made the decision to implement AI directly into the software so
                        it's ready to use as soon as you get it! I truly believe that AI, when used correctly, can be a
                        powerful and fun tool for content creation.</p>

                    <p>However, providing built-in AI comes with a monthly cost per person. To be able to support the
                        product for the long term, cover these API costs, and continue developing new features, a
                        monthly subscription model is necessary. Thank you for supporting independent development!</p>

                </div>
            </div>
        </section>

        <!-- ROADMAP SECTION -->
        <section class="roadmap-section">
            <div class="roadmap-container">
                <h2>ğŸš€ Future Roadmap</h2>
                <div class="roadmap-timeline">

                    <div class="roadmap-item">
                        <div class="roadmap-marker"></div>
                        <div class="roadmap-content">
                            <h3>ğŸ­ Expressive Avatars</h3>
                            <p>Upgrading the PNG Pet system to support 5-8 distinct emotional states. When Viri uses
                                emojis like "Smug", the avatar will react with specific emotional image swaps instead of
                                just open/close mouth animations.</p>
                        </div>
                    </div>

                    <div class="roadmap-item">
                        <div class="roadmap-marker"></div>
                        <div class="roadmap-content">
                            <h3>ğŸ›¡ï¸ Enhanced Moderation Suite</h3>
                            <p>Expanding built-in moderation tools to give Viri more granular control and automated
                                protection capabilities directly from the dashboard.</p>
                        </div>
                    </div>

                    <div class="roadmap-item">
                        <div class="roadmap-marker"></div>
                        <div class="roadmap-content">
                            <h3>ğŸ“¡ VirCast Ecosystem</h3>
                            <p>Seamless integration with <strong>VirCast</strong> (my custom audio tool) to make 2-PC
                                audio routing effortless and high-quality.</p>
                        </div>
                    </div>

                    <div class="roadmap-item">
                        <div class="roadmap-marker"></div>
                        <div class="roadmap-content">
                            <h3>ğŸ“º Multi-Stream Support (Future)</h3>
                            <p>Bringing Viri's presence beyond Twitch. Full integration for YouTube streaming is planned
                                for a future update.</p>
                        </div>
                    </div>

                    <div class="roadmap-item">
                        <div class="roadmap-marker"></div>
                        <div class="roadmap-content">
                            <h3>ğŸŒ Cross-Chat Intelligence</h3>
                            <p>Viri will be able to moderate and bridge conversations across multiple platforms
                                simultaneously, keeping your community connected.</p>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <section id="pricing" class="pricing">

            <section id="pricing" class="pricing">
                <h2>Simple Pricing</h2>
                <div class="price-card">
                    <h3>ViriTTS Pro</h3>
                    <div class="price">$12<span>/month</span></div>
                    <ul class="features-list">
                        <li>Unlimited AI Chat Responses</li>
                        <li>Built-in No Cost to You AI</li>
                        <li>Custom TTS Voices</li>
                        <li>Stream Overlay & PNG Tuber</li>
                        <li>1-PC License (Reset anytime)</li>
                        <li>Priority Support</li>
                    </ul>
                    <a class="btn disabled" aria-disabled="true">ViriTTS (Coming Soon)</a>
                    <p style="margin-top: 1rem; font-size: 0.9rem; color: var(--text-secondary);">
                        Secure payment via Stripe. Cancel anytime.
                    </p>
                </div>
            </section>

            <footer>
                <p>&copy; 2026 ViriTTS. All rights reserved.</p>
            </footer>
    </div>

    <!-- Mouse Reactive Background Script -->
    <script>
        const bg = document.getElementById('interactive-bg');
        const particles = [];
        const particleCount = 25;

        // Initialize particles
        for (let i = 0; i < particleCount; i++) {
            const p = document.createElement('div');
            p.classList.add('particle');

            // Random properties
            const size = Math.random() * 100 + 50;
            const x = Math.random() * 100;
            const y = Math.random() * 100;

            p.style.width = `${size}px`;
            p.style.height = `${size}px`;
            p.style.left = `${x}%`;
            p.style.top = `${y}%`;

            // Store original position for parallax calculation
            particles.push({
                el: p,
                x: x,
                y: y,
                speed: Math.random() * 0.05 + 0.02 // Depth factor
            });

            bg.appendChild(p);
        }

        // Mouse move handler
        document.addEventListener('mousemove', (e) => {
            const mouseX = e.clientX;
            const mouseY = e.clientY;
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;

            particles.forEach(p => {
                const moveX = (mouseX - centerX) * p.speed;
                const moveY = (mouseY - centerY) * p.speed;

                // Move AWAY from mouse or WITH mouse (parallax)
                // Using transform for performance
                p.el.style.transform = `translate(${moveX}px, ${moveY}px)`;
            });
        });

        // Scroll Animation Observer
        const observerOptions = {
            threshold: 0.1,
            rootMargin: "0px 0px -50px 0px"
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                } else {
                    entry.target.classList.remove('visible'); // Reset animation
                }
            });
        }, observerOptions);

        // Elements to animate
        document.querySelectorAll('.feature-card, .showcase-item, .pricing, .spotlight, .about-section, .roadmap-section').forEach(el => {
            observer.observe(el);
        });

        // Lightbox Logic
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightbox-img');

        document.querySelectorAll('.hero-image, .showcase-img').forEach(img => {
            img.addEventListener('click', () => {
                lightboxImg.src = img.src;
                lightbox.classList.add('active');
            });
        });

        lightbox.addEventListener('click', () => {
            lightbox.classList.remove('active');
        });

        // Fetch Latest Version from Supabase
        async function fetchLatestVersion() {
            const SUPABASE_URL = 'https://rgigtqpesabuyaumibaj.supabase.co';
            const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJnaWd0cXBlc2FidXlhdW1pYmFqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg3NTA2OTcsImV4cCI6MjA4NDMyNjY5N30.MaMvKpVPqCQONsNaYifkSvVFmYbT5c4HYpi_qieN4H0';
            
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/announcements?active=eq.true&order=created_at.desc&limit=1`, {
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
                    }
                });
                const data = await response.json();
                if (data && data.length > 0) {
                    const latest = data[0];
                    const btn = document.getElementById('latest-download-btn');
                    if (btn) {
                        btn.innerText = `Download v${latest.version}`;
                        // If there's a download URL, we could link it, but usually we want them to login
                        // btn.href = latest.download_url || 'account.html';
                    }
                }
            } catch (err) {
                console.error('Failed to fetch latest version:', err);
            }
        }
        fetchLatestVersion();

        // â”€â”€ Beta Testers Carousel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        async function buildTestersCarousel() {
          const SUPABASE_URL      = 'https://rgigtqpesabuyaumibaj.supabase.co';
          const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJnaWd0cXBlc2FidXlhdW1pYmFqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg3NTA2OTcsImV4cCI6MjA4NDMyNjY5N30.MaMvKpVPqCQONsNaYifkSvVFmYbT5c4HYpi_qieN4H0';

          const stage      = document.getElementById('testers-stage');
          const dotsWrap   = document.getElementById('testers-dots');
          const countBadge = document.getElementById('testers-count');
          if (!stage) return;

          // â”€â”€ Fetch active testers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          let testers = [];
          try {
            const res  = await fetch(`${SUPABASE_URL}/functions/v1/get-testers`, {
              headers: { apikey: SUPABASE_ANON_KEY }
            });
            const data = await res.json();
            if (Array.isArray(data.testers) && data.testers.length) testers = data.testers;
          } catch (err) {
            console.warn('Testers carousel fetch failed:', err);
          }

          if (!testers.length) {
            testers = [
              { twitch: 'cryzera',  display: 'CryZera'  },
              { twitch: null,       display: 'Tester 2' },
              { twitch: null,       display: 'Tester 3' },
            ];
          }

          countBadge.textContent = testers.length + ' tester' + (testers.length !== 1 ? 's' : '');

          // â”€â”€ Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          function esc(s) {
            return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
          }

          function makeCard(t) {
            const card     = document.createElement('div');
            card.className = 'tester-card';
            const initials = (t.display||'??').slice(0,2).toUpperCase();

            // Avatar: use server-resolved URL first, then fall back to placeholder
            const avatarSrc = t.avatar || null;

            if (avatarSrc) {
              const img     = document.createElement('img');
              img.className = 'tester-avatar';
              img.alt       = t.display;
              img.src       = avatarSrc;
              img.onerror   = () => {
                const ph       = document.createElement('div');
                ph.className   = 'tester-avatar-placeholder';
                ph.textContent = initials;
                img.replaceWith(ph);
              };
              card.appendChild(img);
            } else {
              const ph       = document.createElement('div');
              ph.className   = 'tester-avatar-placeholder';
              ph.textContent = initials;
              card.appendChild(ph);
            }

            const info     = document.createElement('div');
            info.className = 'tester-info';
            info.innerHTML = t.twitch
              ? `<div class="tester-name">${esc(t.display)}</div><div class="tester-twitch">twitch.tv/${esc(t.twitch)}</div>`
              : `<div class="tester-name">${esc(t.display)}</div>`;
            card.appendChild(info);
            return card;
          }

          // â”€â”€ Build slots (one per tester) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          // Each slot wraps a card. We only show 5 slots: far-prev, prev, active, next, far-next
          // and reuse them by updating content + class as index changes.

          const VISIBLE = 5; // must be odd
          const slots   = [];
          for (let i = 0; i < VISIBLE; i++) {
            const slot     = document.createElement('div');
            slot.className = 'tester-slot hidden';
            stage.appendChild(slot);
            slots.push(slot);
          }

          // Dot indicators
          const dots = [];
          if (testers.length > 1) {
            testers.forEach((_, i) => {
              const d       = document.createElement('div');
              d.className   = 'testers-dot';
              d.addEventListener('click', () => goTo(i));
              dotsWrap.appendChild(d);
              dots.push(d);
            });
          }

          let current = 0;
          const slotClasses = ['far-prev','prev','active','next','far-next'];

          function render(direction = 1) {
            const half  = Math.floor(VISIBLE / 2); // 2
            const total = testers.length;

            slots.forEach((slot, si) => {
              const offset = si - half;             // -2,-1,0,+1,+2
              const ti     = ((current + offset) % total + total) % total;

              // Rebuild card content
              slot.innerHTML = '';
              slot.appendChild(makeCard(testers[ti]));

              // Determine position class
              let cls = slotClasses[si];
              if (total === 1 && si !== 2)       cls = 'hidden';
              if (total === 2 && (si === 0 || si === 4)) cls = 'hidden';

              // For the active slot, briefly strip the animation class so it re-fires
              if (cls === 'active') {
                slot.className = 'tester-slot';
                // Force reflow so removing the class takes effect before we re-add it
                void slot.offsetWidth;
              }

              slot.className = 'tester-slot ' + cls;
            });

            dots.forEach((d, i) => d.classList.toggle('active', i === current));
          }

          function goTo(idx) {
            current = ((idx % testers.length) + testers.length) % testers.length;
            render();
          }

          function advance() { goTo(current + 1); }

          render();

          // Auto-advance every 3.5 seconds
          if (testers.length > 1) {
            setInterval(advance, 3500);
          }
        }

        buildTestersCarousel();
    </script>
</body>

</html>